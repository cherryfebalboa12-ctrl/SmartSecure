<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8">
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <title>SmartSecure Object Detection Scanner (Enhanced)</title>

Â  Â  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
Â  Â  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>

Â  <style>
Â  Â  :root {
Â  Â  Â  --primary-color: #007bff; /* Blue for a modern look */
Â  Â  Â  --background-color: #f0f2f5;
Â  Â  Â  --container-color: #ffffff;
Â  Â  Â  --text-color: #333;
Â  Â  Â  --shadow-color: rgba(0, 0, 0, 0.15);
Â  Â  Â  --safe-color: #28a745; /* Green */
Â  Â  Â  --threat-color: #dc3545; /* Red */
Â  Â  Â  --warning-color: #ffc107; /* Yellow */
Â  Â  }

Â  Â  body {
Â  Â  Â  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
Â  Â  Â  background: var(--background-color);
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: center;
Â  Â  Â  align-items: flex-start;
Â  Â  Â  min-height: 100vh;
Â  Â  Â  padding: 20px;
Â  Â  Â  margin: 0;
Â  Â  }

Â  Â  .container {
Â  Â  Â  background: var(--container-color);
Â  Â  Â  padding: 30px;
Â  Â  Â  border-radius: 12px;
Â  Â  Â  box-shadow: 0 10px 20px var(--shadow-color);
Â  Â  Â  text-align: center;
Â  Â  Â  max-width: 700px;
Â  Â  Â  width: 100%;
Â  Â  Â  margin-top: 30px;
Â  Â  }

Â  Â  h1 {
Â  Â  Â  color: var(--primary-color);
Â  Â  Â  margin-bottom: 5px;
Â  Â  Â  font-size: 2rem;
Â  Â  }

Â  Â  p {
Â  Â  Â  color: #6c757d;
Â  Â  Â  margin-bottom: 20px;
Â  Â  }

Â  Â  .video-wrapper {
Â  Â  Â  position: relative;
Â  Â  Â  margin: 0 auto 20px auto;
Â  Â  Â  display: block;
Â  Â  Â  width: 640px; /* Standardizing for visual consistency */
Â  Â  Â  height: 480px;
Â  Â  Â  box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
Â  Â  Â  border-radius: 8px;
Â  Â  Â  overflow: hidden;
Â  Â  }

Â  Â  #webcam, #detectionCanvas {
Â  Â  Â  position: absolute;
Â  Â  Â  top: 0;
Â  Â  Â  left: 0;
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100%;
Â  Â  Â  object-fit: cover;
Â  Â  Â  border-radius: 8px;
Â  Â  }
Â  Â  /* Initial hide for better loading transition */
Â  Â  #webcam, #detectionCanvas { visibility: hidden; }
Â  Â  #webcam.active, #detectionCanvas.active { visibility: visible; }


Â  Â  #status {
Â  Â  Â  margin-top: 15px;
Â  Â  Â  font-weight: bold;
Â  Â  Â  padding: 15px;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  background-color: #e9ecef;
Â  Â  Â  color: var(--text-color);
Â  Â  Â  transition: all 0.3s ease;
Â  Â  Â  font-size: 1.1rem;
Â  Â  Â  min-height: 25px; /* Prevent layout shift */
Â  Â  }

Â  Â  #status.safe {
Â  Â  Â  color: var(--safe-color);
Â  Â  Â  background-color: #d4edda;
Â  Â  Â  border: 1px solid var(--safe-color);
Â  Â  }

Â  Â  #status.threat {
Â  Â  Â  color: var(--threat-color);
Â  Â  Â  background-color: #f8d7da;
Â  Â  Â  border: 1px solid var(--threat-color);
Â  Â  Â  animation: pulse 1s infinite alternate;
Â  Â  }

Â  Â  #status.warning {
Â  Â  Â  color: #856404;
Â  Â  Â  background-color: #fff3cd;
Â  Â  Â  border: 1px solid var(--warning-color);
Â  Â  }

Â  Â  @keyframes pulse {
Â  Â  Â  from { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.7); }
Â  Â  Â  to { box-shadow: 0 0 0 10px rgba(220, 53, 69, 0); }
Â  Â  }
Â  </style>
</head>
<body>
Â  <div class="container">
Â  Â  <h1>SmartSecure Live Scanner ğŸ›¡ï¸</h1>
Â  Â  <p>Real-time Object Detection for Security Screening (COCO-SSD)</p>

Â  Â  <div id="videoWrapper" class="video-wrapper">
Â  Â  Â  <video id="webcam" autoplay playsinline></video>
Â  Â  Â  <canvas id="detectionCanvas"></canvas>
Â  Â  </div>

Â  Â  Â  Â  <div id="status">â³ Loading Model...</div>
Â  Â  <p id="sound-note" style="color:#6c757d; font-size:0.9rem;">Tap anywhere to enable immediate high-priority sound alerts.</p>
Â  </div>

Â  <script>
Â  Â  const video = document.getElementById('webcam');
Â  Â  const canvas = document.getElementById('detectionCanvas');
Â  Â  const ctx = canvas.getContext('2d');
Â  Â  const statusBox = document.getElementById('status');
Â  Â  const soundNote = document.getElementById('sound-note');
Â  Â  // Using a simple beep sound for a real alert.
Â  Â  // In production, this would be a high-priority alarm sound.
Â  Â  const ALERT_SOUND_BEEP = 'data:audio/mp3;base64,SUQzBAAAAAABVVlMRVMzLjkuMAAAAUZZSU5HAAAAJwAAAABJc29tZXRpbWUgLyBMYXZmNTcuODMuMTAwAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV Rameshwotting'; is not a valid audio base64 string.
Â  Â  
Â  Â  let audioContext = null;
Â  Â  let soundEnabled = false;

Â  Â  // Enhanced list of potential threats, including misclassification targets
Â  Â  const DANGEROUS_OBJECTS = ["knife", "gun", "scissors", "baseball bat", "handgun", "baseball_bat", "firearm", "rifle", "sword"];
Â  Â  const LOW_CONFIDENCE_THRESHOLD = 0.5; // New constant for better threshold management
Â  Â  const DANGER_CONFIDENCE_THRESHOLD = 0.8; // High confidence for confirmed threats

Â  Â  // Aggressively broad dangerous objects list (for a security context)
Â  Â  const DANGEROUS_ALIASES = {
Â  Â  Â  "bottle": "blunt_object", // Potential blunt weapon
Â  Â  Â  "cell phone": "distraction_device", // Cell phone as a forbidden item in secure areas
Â  Â  Â  "tvmonitor": "large_screen_object" // Placeholder for an overly large/unusual item
Â  Â  };

Â  Â  // Map to correct common COCO-SSD mislabels (can be expanded with domain-specific knowledge)
Â  Â  const LABEL_CORRECTION_MAP = {
Â  Â  Â  "fork": "utensil",
Â  Â  Â  "spoon": "utensil",
Â  Â  Â  "remote": "electronic_item",
Â  Â  Â  "keyboard": "electronic_item",
Â  Â  Â  "chair": "furniture",
Â  Â  Â  "couch": "furniture",
Â  Â  Â  "handbag": "bag",
Â  Â  Â  "backpack": "bag",
Â  Â  Â  "tennis racket": "sports_equipment",
Â  Â  Â  "cup": "container",
Â  Â  Â  "bowl": "container"
Â  Â  };

Â  Â  function correctLabel(originalLabel) {
Â  Â  Â  return LABEL_CORRECTION_MAP[originalLabel] || originalLabel;
Â  Â  }
Â  Â  
Â  Â  function getObjectStatus(label, score) {
Â  Â  Â  const correctedLabel = correctLabel(label);
Â  Â  Â  const lowerLabel = correctedLabel.toLowerCase();

Â  Â  Â  if (DANGEROUS_OBJECTS.includes(lowerLabel)) {
Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  isThreat: true,
Â  Â  Â  Â  Â  isWarning: false,
Â  Â  Â  Â  Â  type: "Threat",
Â  Â  Â  Â  Â  color: "var(--threat-color)"
Â  Â  Â  Â  };
Â  Â  Â  }

Â  Â  Â  // Treat low-confidence detections of non-common items as a warning
Â  Â  Â  if (score < DANGER_CONFIDENCE_THRESHOLD && score >= LOW_CONFIDENCE_THRESHOLD && DANGEROUS_ALIASES[lowerLabel]) {
Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  isThreat: false,
Â  Â  Â  Â  Â  isWarning: true,
Â  Â  Â  Â  Â  type: "Warning",
Â  Â  Â  Â  Â  color: "var(--warning-color)"
Â  Â  Â  Â  };
Â  Â  Â  }

Â  Â  Â  return {
Â  Â  Â  Â  isThreat: false,
Â  Â  Â  Â  isWarning: false,
Â  Â  Â  Â  type: "Safe",
Â  Â  Â  Â  color: "var(--safe-color)"
Â  Â  Â  };
Â  Â  }

Â  Â  // Custom Audio Alert Handler using Web Audio API for better control
Â  Â  function initAudio() {
Â  Â  Â  if (audioContext) return;
Â  Â  Â  try {
Â  Â  Â  Â  audioContext = new (window.AudioContext || window.webkitAudioContext)();
Â  Â  Â  Â  const audio = new Audio(ALERT_SOUND_BEEP);
Â  Â  Â  Â  // Initial play/pause to fulfill browser user interaction requirement
Â  Â  Â  Â  audio.play().then(() => {
Â  Â  Â  Â  Â  audio.pause();
Â  Â  Â  Â  Â  audioContext.close().catch(()=>{}); // Close if not needed immediately
Â  Â  Â  Â  Â  audioContext = new (window.AudioContext || window.webkitAudioContext)(); // Re-initialize
Â  Â  Â  Â  Â  soundEnabled = true;
Â  Â  Â  Â  Â  console.log("Sound alerts enabled.");
Â  Â  Â  Â  Â  soundNote.textContent = "ğŸ”Š Sound alerts are active.";
Â  Â  Â  Â  }).catch(err => {
Â  Â  Â  Â  Â  console.warn("Audio initialization failed:", err);
Â  Â  Â  Â  });
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  console.error("Web Audio API not supported:", e);
Â  Â  Â  }
Â  Â  }

Â  Â  function playThreatSound() {
Â  Â  Â  if (!soundEnabled || !audioContext) return;
Â  Â  Â  try {
Â  Â  Â  Â  const oscillator = audioContext.createOscillator();
Â  Â  Â  Â  const gainNode = audioContext.createGain();

Â  Â  Â  Â  oscillator.connect(gainNode);
Â  Â  Â  Â  gainNode.connect(audioContext.destination);

Â  Â  Â  Â  oscillator.type = 'sine';
Â  Â  Â  Â  oscillator.frequency.setValueAtTime(440, audioContext.currentTime); // A4 note
Â  Â  Â  Â  gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);

Â  Â  Â  Â  oscillator.start();
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  oscillator.stop();
Â  Â  Â  Â  }, 150); // Short beep
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  console.error("Error playing sound:", e);
Â  Â  Â  }
Â  Â  }


Â  Â  // Tap anywhere to enable sound (User interaction requirement)
Â  Â  document.body.addEventListener("click", initAudio, { once: true });

Â  Â  async function setupCamera() {
Â  Â  Â  try {
Â  Â  Â  Â  const stream = await navigator.mediaDevices.getUserMedia({
Â  Â  Â  Â  Â  video: {
Â  Â  Â  Â  Â  Â  width: { ideal: 640 },
Â  Â  Â  Â  Â  Â  height: { ideal: 480 },
Â  Â  Â  Â  Â  Â  facingMode: "environment" // Prefer rear camera on mobile
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  Â  video.srcObject = stream;
Â  Â  Â  Â  return new Promise(resolve => {
Â  Â  Â  Â  Â  video.onloadedmetadata = () => {
Â  Â  Â  Â  Â  Â  video.play();
Â  Â  Â  Â  Â  Â  resolve(video);
Â  Â  Â  Â  Â  };
Â  Â  Â  Â  });
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  statusBox.textContent = "âŒ Camera Access Denied or Failed: " + e.message;
Â  Â  Â  Â  statusBox.classList.add("threat");
Â  Â  Â  Â  console.error("Camera setup failed:", e);
Â  Â  Â  }
Â  Â  }

Â  Â  async function run() {
Â  Â  Â  try {
Â  Â  Â  Â  // Optimization: Use WebGL and prefer the lite model for faster FPS
Â  Â  Â  Â  await tf.setBackend('webgl');
Â  Â  Â  Â  const net = await cocoSsd.load('lite_mobilenet_v2'); // Using 'lite' model for performance
Â  Â  Â  Â  statusBox.textContent = "âœ… Model Loaded. Setting up camera...";

Â  Â  Â  Â  const videoElement = await setupCamera();
Â  Â  Â  Â  if (!videoElement) return;

Â  Â  Â  Â  // Set canvas size
Â  Â  Â  Â  canvas.width = videoElement.videoWidth;
Â  Â  Â  Â  canvas.height = videoElement.videoHeight;
Â  Â  Â  Â  
Â  Â  Â  Â  // Activate the elements visually
Â  Â  Â  Â  video.classList.add("active");
Â  Â  Â  Â  canvas.classList.add("active");

Â  Â  Â  Â  statusBox.textContent = "ğŸŸ¢ Scanner Running. Searching...";
Â  Â  Â  Â  statusBox.classList.add("safe");

Â  Â  Â  Â  detectFrame(videoElement, net);

Â  Â  Â  } catch (error) {
Â  Â  Â  Â  statusBox.textContent = "â›” Critical Error: " + error.message;
Â  Â  Â  Â  statusBox.classList.add("threat");
Â  Â  Â  Â  console.error("Initialization failed:", error);
Â  Â  Â  }
Â  Â  }

Â  Â  function detectFrame(video, net) {
Â  Â  Â  net.detect(video).then(predictions => {
Â  Â  Â  Â  ctx.clearRect(0, 0, canvas.width, canvas.height);

Â  Â  Â  Â  let highThreatDetected = false;
Â  Â  Â  Â  let lowWarningDetected = false;
Â  Â  Â  Â  let highestThreatLabel = null;

Â  Â  Â  Â  for (const prediction of predictions) {
Â  Â  Â  Â  Â  // Filter out very low confidence predictions
Â  Â  Â  Â  Â  if (prediction.score < LOW_CONFIDENCE_THRESHOLD) continue;

Â  Â  Â  Â  Â  const status = getObjectStatus(prediction.class, prediction.score);
Â  Â  Â  Â  Â  const correctedLabel = correctLabel(prediction.class);
Â  Â  Â  Â  Â  const labelWithScore = `${correctedLabel} (${(prediction.score * 100).toFixed(1)}%)`;

Â  Â  Â  Â  Â  // Set the overall detection status
Â  Â  Â  Â  Â  if (status.isThreat) {
Â  Â  Â  Â  Â  Â  highThreatDetected = true;
Â  Â  Â  Â  Â  Â  highestThreatLabel = highestThreatLabel || labelWithScore;
Â  Â  Â  Â  Â  } else if (status.isWarning) {
Â  Â  Â  Â  Â  Â  lowWarningDetected = true;
Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  // Draw Bounding Box
Â  Â  Â  Â  Â  const boxColor = status.color;
Â  Â  Â  Â  Â  const [x, y, width, height] = prediction.bbox;

Â  Â  Â  Â  Â  ctx.beginPath();
Â  Â  Â  Â  Â  ctx.rect(x, y, width, height);
Â  Â  Â  Â  Â  ctx.lineWidth = status.isThreat ? 5 : 3; // Thicker border for threats
Â  Â  Â  Â  Â  ctx.strokeStyle = boxColor;
Â  Â  Â  Â  Â  ctx.stroke();

Â  Â  Â  Â  Â  // Draw Label Text Background
Â  Â  Â  Â  Â  ctx.font = "18px 'Segoe UI' bold";
Â  Â  Â  Â  Â  const textWidth = ctx.measureText(labelWithScore).width;
Â  Â  Â  Â  Â  const textHeight = 20;
Â  Â  Â  Â  Â  const textY = y > 25 ? y - 25 : 0;Â 

Â  Â  Â  Â  Â  ctx.fillStyle = boxColor;
Â  Â  Â  Â  Â  ctx.fillRect(x - 1, textY, textWidth + 12, textHeight + 5);
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // Draw the Text
Â  Â  Â  Â  Â  ctx.fillStyle = "white";
Â  Â  Â  Â  Â  ctx.fillText(
Â  Â  Â  Â  Â  Â  labelWithScore,
Â  Â  Â  Â  Â  Â  x + 5,
Â  Â  Â  Â  Â  Â  y > 25 ? y - 5 : 20
Â  Â  Â  Â  Â  );
Â  Â  Â  Â  }

Â  Â  Â  Â  // Update Global Status
Â  Â  Â  Â  if (highThreatDetected) {
Â  Â  Â  Â  Â  statusBox.textContent = `ğŸš¨ IMMEDIATE THREAT: ${highestThreatLabel.split(' ')[0]} detected!`;
Â  Â  Â  Â  Â  statusBox.classList.remove("safe", "warning");
Â  Â  Â  Â  Â  statusBox.classList.add("threat");
Â  Â  Â  Â  Â  playThreatSound();
Â  Â  Â  Â  } else if (lowWarningDetected) {
Â  Â  Â  Â  Â  statusBox.textContent = "âš ï¸ Warning: Low-confidence detection or restricted item found.";
Â  Â  Â  Â  Â  statusBox.classList.remove("safe", "threat");
Â  Â  Â  Â  Â  statusBox.classList.add("warning");
Â  Â  Â  Â  Â  // Optional: play a softer warning sound here
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  statusBox.textContent = "âœ… System Clear. Scanning...";
Â  Â  Â  Â  Â  statusBox.classList.remove("threat", "warning");
Â  Â  Â  Â  Â  statusBox.classList.add("safe");
Â  Â  Â  Â  }

Â  Â  Â  Â  // Loop the detection process
Â  Â  Â  Â  requestAnimationFrame(() => detectFrame(video, net));
Â  Â  Â  }).catch(err => {
Â  Â  Â  Â  console.error("Detection failed:", err);
Â  Â  Â  Â  // Add a non-fatal error status
Â  Â  Â  Â  statusBox.textContent = "Scanning Interrupted (Check Console)";
Â  Â  Â  Â  statusBox.classList.add("warning");
Â  Â  Â  });
Â  Â  }

Â  Â  run();
Â  </script>
</body>
</html>
